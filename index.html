<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stacking Calculator</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app">
    <header>
      <h1>Total Battle Stacking Calculator</h1>
      <p class="intro">
        Tell the calculator what your hero can field, set the leadership cap, and decide how much
        extra health lower tiers should carry. Higher tiers stay lean while lower tiers get padded
        so their total health stays tight together.
      </p>
    </header>

    <section class="controls card">
      <div class="control-row">
        <label for="leadership-input">Leadership cap</label>
        <input id="leadership-input" type="number" min="0" value="50000" step="1000">
      </div>

      <div class="control-row">
        <label for="cushion-input">Tier health padding (%)</label>
        <div class="control-stack">
          <input id="cushion-input" type="number" value="10" step="1" min="0" max="100">
          <span class="hint">Lower tiers get MORE health and die first. Example: 10% means S5 has 20% more than S7. Higher health = attacked first.</span>
        </div>
      </div>

      <div class="control-row">
        <label for="branch-cushion-input">Branch health padding (%)</label>
        <div class="control-stack">
          <input id="branch-cushion-input" type="number" value="0" step="0.5" min="0" max="10">
          <span class="hint">Specialists get MORE health than Guards (within tier) and die first. Higher health = attacked first. 0% = even distribution.</span>
        </div>
      </div>

      <div class="control-row">
        <label for="role-cushion-input">Role health padding (%)</label>
        <div class="control-stack">
          <input id="role-cushion-input" type="number" value="0" step="0.5" min="0" max="10">
          <span class="hint">Melee gets MOST health (dies first), Flying gets LEAST (most protected). Higher health = attacked first. 0% = even distribution.</span>
        </div>
      </div>

      <div class="control-row">
        <label for="target-health-input">Reference health target</label>
        <input id="target-health-input" type="number" value="1000000" step="100000" min="100000">
        <span class="hint">Used for per-tier ratios; does not cap total health.</span>
      </div>

      <div class="control-row experimental-feature">
        <label class="checkbox-label">
          <input id="attack-order-stacking" type="checkbox">
          <span>‚öîÔ∏è Attack Order Stacking (Experimental)</span>
        </label>
        <span class="hint">Stack by attack order: Melee ‚Üí Mounted ‚Üí Ranged ‚Üí Flying (melee tanks, flying most protected). Default stacks flying first.</span>
      </div>
    </section>

    <section class="units card">
      <div class="section-header">
        <h2>Troop Access</h2>
      </div>
      <p class="section-blurb">Enable each branch your hero can field, select the highest tier unlocked, then choose which specific tiers to include in your stack. Your selections are saved automatically.</p>
      <div id="branch-controls" class="branch-grid"></div>
    </section>

    <section class="results card">
      <div class="section-header">
        <h2>üõ°Ô∏è Hero Stack Recommendation (Leadership)</h2>
        <div class="header-controls">
          <label class="display-order-toggle">
            <input type="checkbox" id="game-ui-order">
            <span>Game UI Order</span>
          </label>
          <button id="clear-checked-btn" class="clear-checked-btn" title="Clear all checkmarks">Clear Checked</button>
        </div>
      </div>
      <div class="summary" id="summary"></div>
      <div class="army-progress" id="army-progress">
        <div class="army-progress-label">
          <span class="army-icon">‚öîÔ∏è</span>
          <span>Army Built:</span>
        </div>
        <div class="army-progress-bar">
          <div class="army-progress-fill" id="army-progress-fill"></div>
          <div class="army-progress-text" id="army-progress-text">0 / 0</div>
        </div>
      </div>
      <div id="warning" class="warning hidden"></div>
      <div class="table-wrapper">
        <table id="result-table">
          <thead>
            <tr>
              <th class="include-column">Use</th>
              <th class="check-column">‚úì</th>
              <th>Unit</th>
              <th>Role</th>
              <th>Units</th>
              <th>Leadership</th>
              <th>Total Health</th>
              <th>Health Share</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <section class="card">
      <div class="section-header">
        <h2>üêâ Monster Configuration</h2>
      </div>
      <div class="control-row">
        <label for="dominance-input">Hero Dominance Cap</label>
        <div class="control-stack">
          <input id="dominance-input" type="number" value="0" step="1" min="0">
          <span class="hint">Maximum dominance your hero can command for monsters</span>
        </div>
      </div>
      <div class="control-row">
        <label for="monster-mode">Monster Stack Mode</label>
        <div class="control-stack">
          <select id="monster-mode">
            <option value="max">Maximize Dominance</option>
            <option value="match">Match Troop Health</option>
          </select>
          <span class="hint">Maximize: Use full dominance cap. Match: Scale monsters to match lowest troop health pool (prevents monsters dying first).</span>
        </div>
      </div>
      <div class="control-row">
        <label for="monster-cushion-input">Lower-tier health padding (%)</label>
        <div class="control-stack">
          <input id="monster-cushion-input" type="number" value="2.5" step="0.5" min="0" max="100">
          <span class="hint">Gives lower tiers extra HP to protect elite monsters. Start at 0% for even distribution, increase as needed.</span>
        </div>
      </div>
      <p class="section-blurb">Enable monsters, select the highest tier unlocked, then choose which tiers to include. Unlocking a tier gives you all 4 monster types (Dragons, Elementals, Giants, Beasts) at that tier.</p>
      <div id="monster-controls" class="branch-grid"></div>
    </section>

    <section class="results card">
      <div class="section-header">
        <h2>üêâ Monster Stack Recommendation (Dominance)</h2>
        <button id="clear-monsters-btn" class="clear-checked-btn" title="Clear all checkmarks">Clear Checked</button>
      </div>
      <div class="summary" id="monster-summary"></div>
      <div class="army-progress" id="monster-progress">
        <div class="army-progress-label">
          <span class="army-icon">üêâ</span>
          <span>Monster Army Built:</span>
        </div>
        <div class="army-progress-bar">
          <div class="army-progress-fill" id="monster-progress-fill"></div>
          <div class="army-progress-text" id="monster-progress-text">0 / 0</div>
        </div>
      </div>
      <div id="monster-warning" class="warning hidden"></div>
      <div class="table-wrapper">
        <table id="monster-result-table">
          <thead>
            <tr>
              <th class="include-column">Use</th>
              <th class="check-column">‚úì</th>
              <th>Monster</th>
              <th>Type</th>
              <th>Count</th>
              <th>Dominance</th>
              <th>Health Pool</th>
              <th>Health Share</th>
              <th>vs Top Tier</th>
            </tr>
          </thead>
          <tbody id="monster-result-table-body"></tbody>
        </table>
      </div>
    </section>
  </div>

  <script src="app.js"></script>
</body>
</html>
